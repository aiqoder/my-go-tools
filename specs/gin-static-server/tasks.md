# Gin 静态文件服务器开发任务清单

## 任务列表

### T1: 项目初始化
- [ ] **T1.1** 创建 go.mod 文件，定义模块路径和依赖
- [ ] **T1.2** 创建基础目录结构
- [ ] **T1.3** 编写 README.md 包含安装方式和快速开始

### T2: 核心配置系统
- [ ] **T2.1** 定义 `Config` 结构体，包含所有配置项
- [ ] **T2.2** 实现 `Option` 类型和配置函数
- [ ] **T2.3** 实现链式配置的 `With*` 方法

### T3: 缓存层实现
- [ ] **T3.1** 实现 `cacheEntry` 结构体
- [ ] **T3.2** 实现 `Cache` 结构体（使用 sync.Map）
- [ ] **T3.3** 实现缓存 Get/Set 方法
- [ ] **T3.4** 实现 LRU 淘汰逻辑
- [ ] **T3.5** 编写缓存层单元测试和基准测试

### T4: 核心引擎实现
- [ ] **T4.1** 实现 `StaticEngine` 结构体
- [ ] **T4.2** 实现 `New` 和 `NewWithConfig` 构造函数
- [ ] **T4.3** 集成配置系统和缓存层

### T5: 文件处理和压缩
- [ ] **T5.1** 实现文件读取和缓存加载逻辑
- [ ] **T5.2** 实现 Gzip 压缩功能
- [ ] **T5.3** 实现 Byte Pool 复用
- [ ] **T5.4** 编写压缩相关单元测试

### T6: 安全检查
- [ ] **T6.1** 实现目录遍历防护
- [ ] **T6.2** 实现点文件隐藏逻辑

### T7: HTTP 处理器
- [ ] **T7.1** 实现静态文件请求处理
- [ ] **T7.2** 实现 ETag/Last-Modified 支持
- [ ] **T7.3** 实现 304 Not Modified 逻辑
- [ ] **T7.4** 实现 Cache-Control 头设置

### T8: SPA 支持
- [ ] **T8.1** 实现 SPA 回退功能
- [ ] **T8.2** 配置 index.html 路径

### T9: 中间件集成
- [ ] **T9.1** 将处理器注册到 Gin 路由
- [ ] **T9.2** 集成所有功能到中间件链

### T10: 测试和示例
- [ ] **T10.1** 编写完整单元测试（覆盖率目标 ≥80%）
- [ ] **T10.2** 编写基准测试
- [ ] **T10.3** 编写示例代码（examples_test.go）

### T11: 文档完善
- [ ] **T11.1** 完善 README.md（API 示例、性能基准）
- [ ] **T11.2** 生成 go doc 文档注释

---

## 任务依赖关系

```
T1 ─┬─▶ T2 ─┬─▶ T4 ─┬─▶ T5 ─┬─▶ T7 ─┬─▶ T9 ─┬─▶ T10 ─▶ T11
    │       │       │       │       │       │
    │       │       │       │       │       │
    └───────┴───────┘       │       │       │
            │               │       │       │
            ▼               ▼       ▼       ▼
            T3 ─────────────┴───────┴───────┘
            │
            ▼
            T6 ────────────────▶ T7
            │
            ▼
            T8 ────────────────▶ T9
```

## 验收标准

每个任务完成后需满足：
1. 代码编译通过 (`go build`)
2. 单元测试通过 (`go test -v`)
3. 基准测试可运行 (`go test -bench=.`)
4. 符合 go vet 和 golint 检查
